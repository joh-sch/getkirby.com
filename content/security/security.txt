Title: Security Policy

----

Text:

## Supported Versions

{{ versions }}

<info>
If you need the version information from this page in a machine-readable format, you can use the (link: security.json text: JSON representation).
</info>

## Past Security Incidents

{{ incidents }}

## Security Guide

Please follow our (link: docs/guide/security text: security guide) to keep your Kirby installation secure.

## Reporting a Vulnerability

If you have spotted a vulnerability in Kirby's core or the Panel, please make sure to let us know immediately. We take any report very seriously and we will react as soon as possible.

You can always write us directly at **<security@getkirby.com>**.
If you want to encrypt your message, our GPG key is (link: pgp.asc text: 6E6B 057A F491 FFAD 363F  6F49 9101 10FA A459 E120).

Please do *not* write to us publicly, e.g. in the forum, as making security vulnerabilities public before they are fixed can give attackers valuable time to exploit the issue. By letting us know directly, you can protect other Kirby users from such attacks.

----

Docs:

## Format of version constraints

Version constraints use [Composer's version constraint syntax](https://getcomposer.org/doc/articles/versions.md#writing-version-constraints).

## `Versions` field

The `Versions` field allows to find the support status of a particular version and enables update checks (is a new version available, is it an update or upgrade and what is its version number?).

Each entry MUST have a `version` field (Composer version constraint), a `status` (see below) and a human-readable `description`.

Each Kirby version ever released MUST match at least one of the entries' `version` field.
The entries are evaluated from top to bottom, so the "most specific" entry MUST always come before a more general entry.

There MUST be a separate entry with the `status` value `active-support`, `security-support` or `end-of-life` for each major version that requires a paid upgrade.

There MUST be exactly one entry with the `status` value `latest`. It MUST be the first entry in the list.
There also MUST be exactly one entry with the `status` value `no-vulnerabilities`. It MUST be the second entry in the list.

### Possible `status` values

#### `latest`

This is a "fast path" that skips both the update check and the check for known vulnerabilities using the incident list.

The `url` field of the `latest` entry MUST be set to the URL with more information on the latest version.
The `url-upgrade` field of the `latest` entry MUST be set to the marketing URL for users upgrading from a previous major release.

The `latest` entry SHOULD be left untouched as it's auto-populated with the Kirby version of the getkirby.com site.

#### `no-vulnerabilities`

This is a "fast path" that skips the check for known vulnerabilities using the incident list.
During the update check, versions that match this entry are compared against the `latest` entry (see above).

The `no-vulnerabilities` entry SHOULD be left untouched as it's auto-populated with the latest `fixed` version from the incident list.

#### `active-support`

This marks a version range that receives functionality updates, enhancements and bug fixes.

The `latest` field of the `active-support` entry MUST be set to the latest version within the version range (which can be used to check for free updates within this major release). It SHOULD be set to `{{ latest }}`, which will be auto-populated with the Kirby version of the getkirby.com site.

The `url` field of the `active-support` entry MUST be set to the URL with more information on the latest version within the version range. The `{{ latest }}` placeholder SHOULD be used in the URL.

#### `security-support`

This marks a version range that only receives security updates.

The `latest` field of the `security-support` entry MUST be set to the latest version within the version range (which can be used to check for free updates within this major release).

The `url` field of the `security-support` entry MUST be set to the URL with more information on the latest version within the version range.

#### `end-of-life`

This marks a version range that receives no updates whatsoever.

The `latest` field of the `end-of-life` entry MUST be set to the latest version within the version range (which can be used to check for free updates within this major release).

The `url` field of the `end-of-life` entry MUST be set to the URL with more information on the latest version within the version range.

## `Incidents` field

The `Incidents` field lists all past security incidents (vulnerabilities in Kirby). It allows to check if a particular version is affected by known vulnerabilities. If this is the case, it points to more information and the version(s) that fixed the vulnerability.

Each incident entry MAY have the following fields (required fields are marked with a `*`):

- `description` (*): Human-readable, short description of the vulnerability
- `link` (*): Link to the detailed vulnerability description
- `affected` (*): Composer version constraint of all affected versions that had security support when the vulnerability was discovered;
  the oldest major release SHOULD use the `<=` syntax to cover the previous end-of-life major releases as well (unless they are not affected)
- `fixed` (*): Comma-separated list of all versions that fixed this vulnerability
- `cvss` (*): Vector string for the [Temporal CVSS Score](https://www.first.org/cvss/calculator/3.1)
- `severity` (*): Either `low`, `medium`, `high` or `critical` (according to the CVSS calculator)
- `cve`: Assigned [CVE ID](https://cve.mitre.org), if available
- `cwe`: Comma-separated list of [CWE IDs](https://cwe.mitre.org), if applicable

----

Versions:

-
    version: {{ latest }}
    status: latest
    description: Latest Kirby release
    url: https://github.com/getkirby/kirby/releases/tag/{{ latest }}
    url-upgrade: https://getkirby.com/releases/{{ latestMajor }}
-
    version: >={{ no-vulnerabilities }}
    status: no-vulnerabilities
    description: No known vulnerabilities
-
    version: 3.*
    status: active-support
    description: Actively supported
    latest: {{ latest }}
    url: https://github.com/getkirby/kirby/releases/tag/{{ latest }}
-
    version: 2.*
    status: end-of-life
    description: Not supported (end of life) since January 1, 2021
    latest: 2.5.12
    url: https://github.com/getkirby-v2/kirby/releases/tag/2.5.12
-
    version: 1.*
    status: end-of-life
    description: Not supported (end of life) since February 1, 2016
    latest: 1.1.2
    url: https://github.com/getkirby-v1/starterkit/releases/tag/1.1.2

----

Incidents:

-
    description: "External Initialization of the Panel on .dev domains and some reverse proxy setups"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-2ccx-2gf3-8xvv
    affected: "<=2.5.13 || 3.0.0-3.3.5"
    fixed: 2.5.14, 3.3.6
    cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:H/A:N/E:U/RL:O/RC:R
    severity: medium
    cve: CVE-2020-26253
    cwe: CWE-454
-
    description: "Remote code execution (RCE) from PHP Phar archives uploaded by Panel users as content files"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-g3h8-cg9x-47qw
    affected: "<=2.5.13 || 3.0.0-3.4.4"
    fixed: 2.5.14, 3.4.5
    cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H/E:H/RL:O/RC:C
    severity: critical
    cve: CVE-2020-26255
    cwe: CWE-434
-
    description: "Cross-site scripting (XSS) from unvalidated uploaded SVG or XML files"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-qgp4-5qx6-548g
    affected: "<=3.5.3.1"
    fixed: 3.5.4
    cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N/E:H/RL:O/RC:C
    severity: high
    cve: CVE-2021-29460
    cwe: CWE-79
-
    description: "Cross-site scripting (XSS) from field and configuration text displayed in the Panel"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-2f2w-349x-vrqm
    affected: "<=3.5.6"
    fixed: 3.5.7
    cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N/E:H/RL:O/RC:C
    severity: high
    cve: CVE-2021-32735
    cwe: CWE-80
-
    description: "Cross-site scripting (XSS) from writer field content in the site frontend"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-x7j7-qp7j-hw3q
    affected: 3.5.0-3.5.7.1
    fixed: 3.5.8
    cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C
    severity: medium
    cve: CVE-2021-41252
    cwe: CWE-80
-
    description: "Cross-site scripting (XSS) from image block content in the site frontend"
    link: https://github.com/getkirby/kirby/security/advisories/GHSA-cq58-r77c-5jjw
    affected: 3.5.0-3.5.7.1
    fixed: 3.5.8
    cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N/E:H/RL:O/RC:C
    severity: medium
    cve: CVE-2021-41258
    cwe: CWE-80
